---
import { Image } from 'astro:assets';
import img1 from '../../../assets/images/services/persoenlichkeitsanalyse.jpg';
import img2 from '../../../assets/images/services/persoenlichkeitsentwicklung.jpg';
import img3 from '../../../assets/images/services/kommunikationstraining.jpg';
import img4 from '../../../assets/images/services/mentaltraining.jpg';
import img5 from '../../../assets/images/services/body-reading.jpg';
import img6 from '../../../assets/images/services/atemformenanalyse.jpg';
import img7 from '../../../assets/images/services/ernaehrungsberatung.jpg';

const services = [
  { title: 'Persönlichkeitsanalyse', image: img1 },
  { title: 'Persönlichkeitsentwicklung', image: img2 },
  { title: 'Kommunikationstraining', image: img3 },
  { title: 'Mentaltraining', image: img4 },
  { title: 'Body Reading', image: img5 },
  { title: 'Atemformenanalyse', image: img6 },
  { title: 'Ernährungsberatung', image: img7 },
];
---

<div class="slideshow-container">
  <div class="slideshow-header">
    <p class="subheading">ENTWICKELN SIE SICH WEITER</p>
    <h2 class="heading">Meine Angebote</h2>
  </div>
  <div class="slideshow">
    {services.map((service, index) => (
      <div class={`slide slide-${index}`}>
        <Image src={service.image} alt={service.title} width={800} height={600} />
        <div class="slide-caption">
          <h3>{service.title}</h3>
          <a href="#" class="learn-more">Mehr erfahren</a>
        </div>
      </div>
    ))}
  </div>
</div>

<style>
  .slideshow-container {
    position: relative;
    width: 100%;
    height: 100%;
    min-height: 400px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  .slideshow-header {
    text-align: left;
  }
  .subheading {
    font-size: var(--font-size-sm);
    letter-spacing: 0.1rem;
    color: var(--theme-primary);
    font-weight: bold;
    margin: 0;
    text-transform: uppercase;
  }
  .heading {
    font-size: var(--font-size-lg);
    margin: 0;
  }
  .slideshow {
    position: relative;
    width: 100%;
    height: 450px;
    overflow: hidden;
    border-radius: var(--theme-shape-radius);
    box-shadow: var(--theme-card-shadow);
    background-color: var(--theme-surface-1);
  }
  .slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    z-index: 1;
    transition: opacity 1s ease-in-out;
    animation: slideShow 28s infinite; /* 7 slides * 4s */
  }
  /* Ensure the first slide is visible initially while the animation loads */
  .slide-0 {
    opacity: 1;
    z-index: 2;
  }
  
  .slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .slide-caption {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 2rem 1.5rem 1.5rem 1.5rem;
    background: linear-gradient(transparent, rgba(0,0,0,0.9));
    color: white;
    z-index: 3;
  }
  .slide-caption h3 {
    margin: 0;
    font-size: var(--font-size-md);
    font-weight: 600;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }
  .learn-more {
    display: inline-block;
    margin-top: 0.5rem;
    color: white;
    text-decoration: none;
    font-size: var(--font-size-sm);
    font-weight: 500;
    border-bottom: 2px solid var(--theme-surface-2);
    transition: all 0.2s ease;
  }
  .learn-more:hover {
    color: var(--theme-surface-2);
    border-bottom-color: white;
  }

  /* 
     Logic: 100% / 7 slides = 14.28% per slide.
     We want each slide to be fully opaque for most of its duration 
     and cross-fade with the previous/next one.
  */
  @keyframes slideShow {
    0% { opacity: 0; z-index: 1; }
    2% { opacity: 1; z-index: 2; }
    14% { opacity: 1; z-index: 2; }
    16% { opacity: 0; z-index: 1; }
    100% { opacity: 0; z-index: 1; }
  }

  .slide-0 { animation-delay: 0s; }
  .slide-1 { animation-delay: 4s; }
  .slide-2 { animation-delay: 8s; }
  .slide-3 { animation-delay: 12s; }
  .slide-4 { animation-delay: 16s; }
  .slide-5 { animation-delay: 20s; }
  .slide-6 { animation-delay: 24s; }

  @media (max-width: 768px) {
    .slideshow {
      height: 350px;
    }
  }
</style>
